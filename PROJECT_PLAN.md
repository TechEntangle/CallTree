# CallTree Development Plan - Project Tasks

**Total Duration**: ~20 weeks  
**MVP Target**: 12 weeks (Stages 0-5)  
**Full v1.0**: 20 weeks (All stages)

---

## ðŸ“Š Progress Overview

- [ ] Stage 0: Project Setup & Infrastructure (Week 1)
- [ ] Stage 1: Authentication & User Management (Week 2-3)
- [ ] Stage 2: Calling Tree Management (Week 4-6)
- [ ] Stage 3: Notification System - Core (Week 7-9)
- [ ] Stage 4: Real-Time Dashboard & Response Tracking (Week 10-11)
- [ ] Stage 5: Calling Tree Cascade Logic (Week 12-13)
- [ ] Stage 6: Document & Resource Management (Week 14-15)
- [ ] Stage 7: Advanced Features & Polish (Week 16-18)
- [ ] Stage 8: Testing, Bug Fixes & Deployment Prep (Week 19-20)
- [ ] Stage 9: Launch & Post-Launch (Week 21+)

---

## **STAGE 0: Project Setup & Infrastructure** (Week 1)

### 0.1 Project Initialization
- [ ] Create GitHub organization/repository
  - [ ] `/backend` - Supabase migrations, edge functions
  - [ ] `/web` - React admin portal
  - [ ] `/mobile` - React Native Expo app
  - [ ] `/shared` - Shared types, utilities
  - [ ] `/docs` - Documentation
- [ ] Set up GitHub Projects or Trello for task management
- [ ] Define git workflow (main, develop, feature branches)
- [ ] Create development standards document

### 0.2 Supabase Setup
- [ ] Create Supabase project (free tier)
- [ ] Set up development environment variables
- [ ] Configure Apple Sign In
  - [ ] Apple Developer account setup
  - [ ] Create App ID and Service ID
  - [ ] Enable Sign in with Apple capability
  - [ ] Configure in Supabase Auth
- [ ] Configure Google Sign In
  - [ ] Google Cloud Console project
  - [ ] Create OAuth 2.0 credentials
  - [ ] Configure in Supabase Auth
- [ ] Set up local development with Supabase CLI
- [ ] Configure Supabase Studio access

### 0.3 Web Project Setup
- [ ] Initialize React + TypeScript + Vite project
- [ ] Install core dependencies
  - [ ] `@supabase/supabase-js`
  - [ ] `@tanstack/react-query`
  - [ ] `zustand`
  - [ ] `tailwindcss`
  - [ ] `@radix-ui` components (via shadcn/ui)
- [ ] Set up React Router for navigation
- [ ] Configure environment variables (.env.local)
- [ ] Set up ESLint + Prettier
- [ ] Create folder structure (components, pages, hooks, services, types)
- [ ] Test local development server

### 0.4 Mobile Project Setup
- [ ] Initialize Expo project with TypeScript
  - [ ] `npx create-expo-app mobile --template`
- [ ] Install dependencies
  - [ ] `@supabase/supabase-js`
  - [ ] `expo-auth-session`
  - [ ] `expo-web-browser`
  - [ ] `expo-notifications`
  - [ ] `@react-navigation/native`
  - [ ] `react-native-paper` or `native-base`
- [ ] Configure app.json for iOS and Android
- [ ] Set up iOS simulator (Mac)
- [ ] Set up Android emulator
- [ ] Configure deep linking for OAuth redirects
- [ ] Test app runs on both platforms

### 0.5 Shared Resources
- [ ] Create shared TypeScript types/interfaces
- [ ] Define database types (will be generated by Supabase)
- [ ] Create constants file (roles, notification types, colors)
- [ ] Set up shared utilities (date formatting, validation)
- [ ] Create API response format types

### âœ… Stage 0 Deliverables:
- All projects initialized and running locally
- Supabase project configured with social auth
- Development environment documented
- Ready to start feature development

---

## **STAGE 1: Authentication & User Management** (Week 2-3)

### 1.1 Database Schema - Users & Auth
- [ ] Create migration: `001_initial_schema.sql`
  - [ ] `organizations` table
  - [ ] `profiles` table (extends auth.users)
  - [ ] `roles` table
  - [ ] `user_roles` junction table
  - [ ] `departments` table
- [ ] Set up Row Level Security (RLS) policies
  - [ ] Organizations: Users see only their org
  - [ ] Profiles: Users see only their org members
  - [ ] Roles: Public read, admin write
- [ ] Create database trigger: `on_auth_user_created`
  - [ ] Auto-create profile on signup
  - [ ] Assign default role
- [ ] Seed initial data (SQL script)
  - [ ] Default roles (super_admin, org_admin, user, etc.)
  - [ ] Test organization
  - [ ] Test users

### 1.2 Web - Authentication
- [ ] Create Supabase client configuration
- [ ] Build login page UI
  - [ ] Sign in with Apple button
  - [ ] Sign in with Google button
  - [ ] Email/password form (optional)
- [ ] Implement authentication flow
  - [ ] Handle OAuth redirects
  - [ ] Store session in local storage
  - [ ] Create auth context/store
- [ ] Create protected route wrapper component
- [ ] Implement logout functionality
- [ ] Add session persistence and restoration
- [ ] Handle authentication errors gracefully

### 1.3 Web - Admin Layout & Navigation
- [ ] Create main dashboard layout
  - [ ] Sidebar navigation
  - [ ] Top header with user menu
  - [ ] Main content area
- [ ] Build navigation menu
  - [ ] Dashboard
  - [ ] Calling Trees
  - [ ] Notifications
  - [ ] Users
  - [ ] Documents
  - [ ] Reports
  - [ ] Settings
- [ ] Create user profile dropdown
  - [ ] View profile
  - [ ] Settings
  - [ ] Logout
- [ ] Implement responsive design (mobile/tablet)

### 1.4 Web - User Management Interface
- [ ] Create users list page
  - [ ] Table with user data
  - [ ] Search by name/email
  - [ ] Filter by role/department
  - [ ] Pagination
  - [ ] Action buttons (edit, delete, activate/deactivate)
- [ ] Build user form component (add/edit modal)
  - [ ] Full name, email
  - [ ] Role assignment (multi-select)
  - [ ] Department assignment
  - [ ] Active/inactive status
  - [ ] Form validation
- [ ] Implement user CRUD operations
  - [ ] Create user
  - [ ] Read/list users
  - [ ] Update user
  - [ ] Soft delete/deactivate user
- [ ] Add user activation/deactivation toggle
- [ ] Create basic profile page for logged-in user
  - [ ] View personal info
  - [ ] Edit profile button

### 1.5 Mobile - Authentication
- [ ] Create splash screen
- [ ] Build welcome/onboarding screen
- [ ] Create login screen
  - [ ] Sign in with Apple button
  - [ ] Sign in with Google button
  - [ ] App branding/logo
- [ ] Implement OAuth flow
  - [ ] Configure expo-auth-session
  - [ ] Handle redirects
  - [ ] Store auth tokens securely
- [ ] Create auth navigation flow
  - [ ] Unauthenticated stack (login)
  - [ ] Authenticated stack (main app)
  - [ ] Auto-navigation based on auth state
- [ ] Add biometric authentication option
  - [ ] expo-local-authentication
  - [ ] Enable Face ID/Touch ID/Fingerprint
  - [ ] Store biometric preference

### 1.6 Mobile - Basic Profile & Navigation
- [ ] Set up navigation structure
  - [ ] Bottom tab navigator
  - [ ] Stack navigators for each section
- [ ] Create home/dashboard screen (placeholder)
- [ ] Create profile screen
  - [ ] Display user information
  - [ ] Email, role, department
  - [ ] Logout button
- [ ] Create settings screen (placeholder for future)

### 1.7 Supabase Configuration
- [ ] Create Edge Function: `handle-new-user`
  - [ ] Triggered on auth.users insert
  - [ ] Create profile record
  - [ ] Assign default user role
  - [ ] Send welcome email (optional)
- [ ] Configure email templates in Supabase
  - [ ] Welcome email
  - [ ] Password reset email
- [ ] Set up password policies
  - [ ] Minimum length
  - [ ] Complexity requirements

### ðŸ§ª Stage 1 Testing:
- [ ] User can sign up with Google on web
- [ ] User can sign up with Apple on web
- [ ] User can sign up with Google on mobile
- [ ] User can sign up with Apple on mobile
- [ ] Admin can log into web portal
- [ ] Admin can create new users
- [ ] Admin can edit user roles
- [ ] Admin can deactivate users
- [ ] User can log into mobile app
- [ ] Biometric login works on mobile
- [ ] RLS policies prevent unauthorized access
- [ ] Sessions persist across page refreshes
- [ ] Logout works correctly

### âœ… Stage 1 Deliverables:
- Working authentication on web and mobile
- User management interface for admins
- Role-based access control foundation
- Secure session management

---

## **STAGE 2: Calling Tree Management** (Week 4-6)

### 2.1 Database Schema - Calling Trees
- [ ] Create migration: `002_calling_trees.sql`
  - [ ] `calling_trees` table
  - [ ] `tree_nodes` table (self-referential foreign key)
  - [ ] `tree_templates` table
- [ ] Set up RLS policies for trees
  - [ ] Users see only their org's trees
  - [ ] Only admins can create/edit/delete
- [ ] Create database functions
  - [ ] `get_tree_hierarchy(tree_id)` - Recursive CTE
  - [ ] `validate_tree_structure(tree_id)` - Check integrity
  - [ ] `count_nodes_per_level(tree_id)` - Statistics
  - [ ] `duplicate_tree(tree_id)` - Clone functionality
- [ ] Create indexes for performance
  - [ ] tree_nodes.tree_id
  - [ ] tree_nodes.parent_node_id
  - [ ] tree_nodes.user_id

### 2.2 Web - Tree List & Basic CRUD
- [ ] Create calling trees list page
  - [ ] Card/table view of trees
  - [ ] Show tree name, type, status (active/inactive)
  - [ ] Show node count, user count
  - [ ] Search and filter
  - [ ] Create new tree button
- [ ] Build tree creation form
  - [ ] Tree name (required)
  - [ ] Description
  - [ ] Tree type selector
  - [ ] Active/inactive toggle
  - [ ] Form validation
- [ ] Implement tree CRUD operations
  - [ ] Create tree
  - [ ] Update tree metadata
  - [ ] Delete tree (with confirmation)
  - [ ] Activate/deactivate tree
- [ ] Add tree duplication feature

### 2.3 Web - Visual Tree Builder Setup
- [ ] Install React Flow library
  - [ ] `@xyflow/react`
- [ ] Create tree visualization component
  - [ ] Initialize React Flow
  - [ ] Custom node components
  - [ ] Connection lines styling
  - [ ] Zoom/pan controls
- [ ] Implement automatic hierarchical layout
  - [ ] Dagre or built-in layout algorithm
  - [ ] Level-based positioning
  - [ ] Proper spacing

### 2.4 Web - Tree Builder Functionality
- [ ] Create user assignment sidebar
  - [ ] List of available users
  - [ ] Search users
  - [ ] Filter by department
  - [ ] Drag handle for each user
- [ ] Implement drag-and-drop
  - [ ] Drag users from sidebar to tree nodes
  - [ ] Visual feedback during drag
  - [ ] Drop validation
  - [ ] Update node with assigned user
- [ ] Create node controls
  - [ ] Add child node button
  - [ ] Remove node button
  - [ ] Edit node settings (timeout, backup)
  - [ ] Node details panel
- [ ] Implement backup contact assignment
  - [ ] Select backup user dropdown
  - [ ] Show backup visually in tree
- [ ] Add timeout configuration per node
  - [ ] Minutes input field
  - [ ] Default value from tree settings

### 2.5 Web - Tree Validation
- [ ] Implement tree validation logic
  - [ ] Check for orphaned nodes (no parent except root)
  - [ ] Ensure all nodes have assigned users
  - [ ] Check for circular references
  - [ ] Validate max depth
  - [ ] Check backup users exist
- [ ] Visual validation feedback
  - [ ] Highlight invalid nodes in red
  - [ ] Show validation errors list
  - [ ] Prevent saving invalid tree
- [ ] Create validation report

### 2.6 Web - Tree Templates
- [ ] Build template saving feature
  - [ ] "Save as Template" button
  - [ ] Template name and description
  - [ ] Save tree structure without user assignments
- [ ] Create templates library
  - [ ] List saved templates
  - [ ] Preview template structure
  - [ ] Load from template
- [ ] Implement template application
  - [ ] Create new tree from template
  - [ ] Copy structure
  - [ ] Prompt for user assignments

### 2.7 Backend - Tree Logic
- [ ] Create Edge Function: `validate-tree`
  - [ ] Input: tree_id
  - [ ] Run validation checks
  - [ ] Return errors array
- [ ] Optimize `get_tree_hierarchy` function
  - [ ] Include user profile data
  - [ ] Include backup user data
  - [ ] Efficient recursive query
- [ ] Create database trigger for tree updates
  - [ ] Update modified timestamp
  - [ ] Log changes

### 2.8 API Integration Layer
- [ ] Create TypeScript types for trees
  - [ ] CallingTree interface
  - [ ] TreeNode interface
  - [ ] TreeTemplate interface
- [ ] Build tree service layer
  - [ ] CRUD operations
  - [ ] Fetch tree hierarchy
  - [ ] User assignment logic
  - [ ] Validation calls
- [ ] Implement optimistic updates with React Query
- [ ] Add comprehensive error handling

### ðŸ§ª Stage 2 Testing:
- [ ] Create simple 3-level calling tree
- [ ] Assign 10+ users to different nodes
- [ ] Visualize tree structure correctly
- [ ] Drag and drop users successfully
- [ ] Add and remove nodes
- [ ] Assign backup contacts
- [ ] Validate tree with missing assignments
- [ ] Validation highlights errors correctly
- [ ] Save and reload tree successfully
- [ ] Create tree from template
- [ ] Duplicate existing tree
- [ ] RLS prevents unauthorized tree access
- [ ] Tree loads quickly (<2 seconds)

### âœ… Stage 2 Deliverables:
- Visual tree builder with drag-and-drop
- Complete tree CRUD operations
- Tree validation system
- Tree templates feature
- Optimized tree data fetching

---

## **STAGE 3: Notification System - Core** (Week 7-9)

### 3.1 Database Schema - Notifications
- [ ] Create migration: `003_notifications.sql`
  - [ ] `notifications` table
  - [ ] `notification_recipients` table
  - [ ] `notification_responses` table
  - [ ] `response_options` table
  - [ ] `device_tokens` table
- [ ] Set up RLS policies
  - [ ] Users see notifications sent to their org
  - [ ] Users see only their own responses
  - [ ] Only admins can create notifications
- [ ] Create database triggers
  - [ ] Auto-create recipients on notification insert
  - [ ] Update notification status on responses
  - [ ] Update recipient read status
- [ ] Create database functions
  - [ ] `get_notification_stats(notification_id)` - Aggregates
  - [ ] `get_recipients_by_level(notification_id, level)` - Filtered list
  - [ ] `get_response_summary(notification_id)` - Counts by type

### 3.2 Push Notification Infrastructure
- [ ] Choose push strategy (Expo Push recommended)
- [ ] Configure Expo Push Notifications
  - [ ] iOS: Set up APNs credentials in Expo
  - [ ] Android: Set up FCM credentials in Expo
  - [ ] Test Expo push notification tool
- [ ] Create Edge Function: `send-push-notifications`
  - [ ] Accept notification payload
  - [ ] Fetch user device tokens from database
  - [ ] Format Expo push messages
  - [ ] Send to Expo Push API (batch requests)
  - [ ] Handle errors and retry logic
  - [ ] Log delivery status
  - [ ] Update recipient delivery status in database

### 3.3 Mobile - Push Notification Setup
- [ ] Request notification permissions
  - [ ] Ask on first app open or onboarding
  - [ ] Explain why permissions needed
  - [ ] Handle permission denial gracefully
- [ ] Register device for push notifications
  - [ ] Get Expo push token
  - [ ] Send token to backend API
  - [ ] Store in device_tokens table with user_id
  - [ ] Update token on app open (if changed)
- [ ] Handle incoming notifications
  - [ ] Foreground: Show in-app notification
  - [ ] Background: System notification
  - [ ] App closed: System notification
  - [ ] Notification tap: Open app to notification detail
- [ ] Implement notification badge count
  - [ ] Update badge on notification receive
  - [ ] Clear badge on notification read
- [ ] Test notifications
  - [ ] Send test notification from Expo tool
  - [ ] Verify receipt on device

### 3.4 Web - Send Notification Interface
- [ ] Create "Send Notification" page
  - [ ] Accessible from navigation and quick actions
- [ ] Build notification composition form
  - [ ] Select calling tree (dropdown, required)
  - [ ] Preview recipient count
  - [ ] Notification type selector (Emergency, Warning, Info, All-Clear, Test)
  - [ ] Priority level (Critical, High, Normal, Low)
  - [ ] Title input (required)
  - [ ] Body textarea or rich text editor
  - [ ] Character count indicator
- [ ] Add response options configuration
  - [ ] Default options: Safe, Need Help, Unable to Respond
  - [ ] Add custom response option
  - [ ] Color picker for custom options
- [ ] Add optional fields
  - [ ] Expiration date/time
  - [ ] Location information
  - [ ] External links
- [ ] Create preview section
  - [ ] Show how notification will appear on mobile
  - [ ] List recipients
  - [ ] Summary of settings
- [ ] Add confirmation dialog
  - [ ] "Are you sure you want to send?"
  - [ ] Show recipient count
  - [ ] Cannot be undone warning
- [ ] Implement send action
  - [ ] Call API to create notification
  - [ ] Show loading state
  - [ ] Success message with link to monitoring page
  - [ ] Error handling

### 3.5 Backend - Notification Processing
- [ ] Create Edge Function: `process-notification`
  - [ ] Input: notification details, tree_id, sender_id
  - [ ] Validate tree exists and is active
  - [ ] Create notification record in database
  - [ ] Fetch Level 0 and Level 1 users from tree
  - [ ] Create recipient records for each user
  - [ ] Call `send-push-notifications` function
  - [ ] Return notification_id and initial status
- [ ] Implement retry mechanism
  - [ ] Queue for failed push notifications
  - [ ] Retry 3 times with exponential backoff
  - [ ] Log failures
- [ ] Create API endpoint: POST `/api/notifications`
  - [ ] Validate request body
  - [ ] Check user permissions
  - [ ] Call process-notification function
  - [ ] Return response

### 3.6 Mobile - Notifications List
- [ ] Create notifications screen
  - [ ] Tab in bottom navigation
  - [ ] Pull-to-refresh
- [ ] Build notification list component
  - [ ] List of notifications (FlatList)
  - [ ] Sort by date (newest first)
  - [ ] Show unread indicator (bold, dot)
  - [ ] Color-coded by type
  - [ ] Show title, preview of body, timestamp
  - [ ] Show response status (if responded)
- [ ] Add search and filter
  - [ ] Search by title/content
  - [ ] Filter by type
  - [ ] Filter by read/unread
- [ ] Implement infinite scroll/pagination
- [ ] Add empty state (no notifications yet)

### 3.7 Mobile - Notification Detail & Response
- [ ] Create notification detail screen
  - [ ] Navigate from list or notification tap
- [ ] Display full notification content
  - [ ] Type badge with color
  - [ ] Priority indicator
  - [ ] Title (large, bold)
  - [ ] Full body text
  - [ ] Sender information
  - [ ] Timestamp
  - [ ] Expiration time (if set)
  - [ ] Location (if provided)
  - [ ] Links (if provided)
- [ ] Mark as read automatically
  - [ ] Update local state
  - [ ] Call API to mark read
  - [ ] Update badge count
- [ ] Build response interface
  - [ ] Show response options as large buttons
  - [ ] Color-coded buttons
  - [ ] Icons for each option
  - [ ] Optional comment text input
  - [ ] Location sharing toggle (if requested)
  - [ ] Submit button
- [ ] Implement response submission
  - [ ] Validate response selected
  - [ ] Gather location (if permitted and toggled)
  - [ ] Call API to submit response
  - [ ] Show success confirmation
  - [ ] Disable response buttons after submission
  - [ ] Show "You responded: [option]" message
- [ ] Handle already responded state
  - [ ] Show previous response
  - [ ] Show timestamp of response
  - [ ] Allow viewing but not changing response

### 3.8 Mobile - Deep Linking
- [ ] Configure deep linking in app.json
  - [ ] Set up URL scheme
  - [ ] Set up universal links (iOS)
  - [ ] Set up App Links (Android)
- [ ] Implement navigation from notification tap
  - [ ] Extract notification_id from notification data
  - [ ] Navigate to notification detail screen
  - [ ] Pass notification_id as parameter
  - [ ] Load notification data

### 3.9 Web - Notification History
- [ ] Create notification history page
  - [ ] Table view of all sent notifications
  - [ ] Columns: Title, Type, Sent At, Recipients, Responses, Status
  - [ ] Sort by date (default: newest first)
  - [ ] Pagination
- [ ] Add filters
  - [ ] Date range picker
  - [ ] Notification type filter
  - [ ] Tree filter
  - [ ] Status filter (active, completed, expired)
  - [ ] Search by title
- [ ] Create notification detail view
  - [ ] Click row to open detail modal/page
  - [ ] Show all notification metadata
  - [ ] Basic statistics (delivered, read, responded)
  - [ ] Link to full monitoring dashboard
  - [ ] Option to resend (future)

### 3.10 API Endpoints
- [ ] POST `/api/notifications` - Create and send notification
- [ ] GET `/api/notifications` - List notifications (with filters)
- [ ] GET `/api/notifications/:id` - Get notification details
- [ ] PUT `/api/notifications/:id/cancel` - Cancel active notification
- [ ] GET `/api/notifications/:id/recipients` - Get recipient status
- [ ] POST `/api/responses` - Submit user response
- [ ] PUT `/api/recipients/:id/mark-read` - Mark notification as read
- [ ] POST `/api/device-tokens` - Register device token
- [ ] DELETE `/api/device-tokens/:token` - Unregister device token

### ðŸ§ª Stage 3 Testing:
- [ ] Send test notification to self
- [ ] Receive push notification on iOS (locked screen)
- [ ] Receive push notification on Android (locked screen)
- [ ] Receive notification with app in foreground
- [ ] Receive notification with app in background
- [ ] Tap notification from system tray opens app to detail
- [ ] Submit response from mobile
- [ ] Response appears in web portal
- [ ] Send notification to 5-user tree (all Level 1)
- [ ] Verify all 5 users receive notification
- [ ] Multiple users submit responses
- [ ] Responses tracked correctly in database
- [ ] Test with device offline, then come online
- [ ] Badge count updates correctly
- [ ] Notification history shows all sent notifications
- [ ] Mark notification as read works

### âœ… Stage 3 Deliverables:
- Working push notifications on iOS & Android
- Send notification interface in web portal
- Mobile notification list and detail screens
- Response submission mechanism
- Notification history in web portal
- Basic delivery and response tracking

---

## **STAGE 4: Real-Time Dashboard & Response Tracking** (Week 10-11)

### 4.1 Supabase Real-time Configuration
- [ ] Enable real-time for tables in Supabase dashboard
  - [ ] notification_recipients
  - [ ] notification_responses
- [ ] Create database publication for real-time
  - [ ] Add tables to replication
- [ ] Test real-time subscriptions
  - [ ] Subscribe to table changes
  - [ ] Verify updates come through

### 4.2 Web - Active Notifications Dashboard
- [ ] Create "Active Notifications" page
  - [ ] Show ongoing notifications (not expired, not all responded)
  - [ ] Accessible from main navigation
- [ ] Build active notifications list
  - [ ] Card view for each notification
  - [ ] Show title, type, sent time, elapsed time
  - [ ] Progress bar (% of recipients responded)
  - [ ] Quick stats (delivered, read, responded, pending)
  - [ ] Click to view detailed monitoring
- [ ] Implement real-time updates
  - [ ] Subscribe to notification_recipients for active notifications
  - [ ] Subscribe to notification_responses for active notifications
  - [ ] Update UI immediately when data changes
  - [ ] Animate updates (subtle flash or pulse)
  - [ ] Show live counter changes
- [ ] Add refresh button (manual refresh option)
- [ ] Auto-remove notification from list when complete

### 4.3 Web - Real-Time Monitoring Detail View
- [ ] Create detailed monitoring page for single notification
  - [ ] Route: `/notifications/:id/monitor`
  - [ ] Full-screen dashboard view
- [ ] Build statistics panel
  - [ ] Total recipients count
  - [ ] Delivered count and percentage
  - [ ] Read count and percentage
  - [ ] Responded count and percentage
  - [ ] Response breakdown by type (Safe: X, Need Help: Y, etc.)
  - [ ] Average response time
  - [ ] Median response time
  - [ ] Non-responders count
  - [ ] Update in real-time
- [ ] Create real-time activity feed
  - [ ] Scrollable list of events
  - [ ] Show as they happen: "John Doe responded: Safe (2 seconds ago)"
  - [ ] Show delivery events
  - [ ] Show read events
  - [ ] Show response events
  - [ ] Auto-scroll to latest
  - [ ] Timestamp for each event
  - [ ] Color-coded by event type

### 4.4 Web - Tree Visualization with Status
- [ ] Integrate React Flow in monitoring view
- [ ] Load calling tree structure
  - [ ] Same tree that was used for notification
  - [ ] Hierarchical layout
- [ ] Color-code nodes by status
  - [ ] Gray: Not yet notified (future levels)
  - [ ] Yellow: Delivered, not read
  - [ ] Blue: Read, awaiting response
  - [ ] Green: Responded - Safe
  - [ ] Red: Responded - Need Help
  - [ ] Orange: Responded - Unable to Comply
  - [ ] Dark Gray: Timeout / No response
- [ ] Update node colors in real-time
  - [ ] Subscribe to recipient status changes
  - [ ] Update node color immediately
  - [ ] Smooth color transition
- [ ] Add level indicators
  - [ ] Show which level is currently active
  - [ ] Show progress per level
  - [ ] Level completion indicator
- [ ] Node interaction
  - [ ] Click node to see user details
  - [ ] Show response time
  - [ ] Show response text (if any)
  - [ ] Manual escalation option (future)

### 4.5 Web - Response Management
- [ ] Create non-responders list section
  - [ ] Table of users who haven't responded
  - [ ] Columns: Name, Department, Delivered At, Time Elapsed
  - [ ] Sort by time elapsed (longest first)
  - [ ] Highlight users who need urgent follow-up
  - [ ] Show contact information (email, phone if available)
  - [ ] Manual escalation button per user (future)
  - [ ] Export list button
- [ ] Build response details view
  - [ ] Table of all responses
  - [ ] Columns: User, Response Type, Response Time, Comment, Location
  - [ ] Filter by response type
  - [ ] Sort by time
  - [ ] Search by user name
  - [ ] Export responses button
- [ ] Implement export functionality
  - [ ] Export non-responders to CSV
  - [ ] Export all responses to CSV
  - [ ] Include all relevant fields
  - [ ] Filename with notification title and date

### 4.6 Backend - Real-time Logic
- [ ] Optimize real-time queries with filters
  - [ ] Subscribe only to specific notification_id
  - [ ] Filter by organization
  - [ ] Reduce payload size
- [ ] Create database function: `get_notification_stats`
  - [ ] Input: notification_id
  - [ ] Aggregate response data
  - [ ] Calculate percentages
  - [ ] Calculate average/median response time
  - [ ] Return formatted statistics object
- [ ] Create Edge Function: `escalate-notification` (stub for now)
  - [ ] Will be used for manual escalation
  - [ ] Accept notification_id, user_id
  - [ ] Create escalation record
  - [ ] Trigger follow-up notification

### 4.7 Web - Analytics Charts
- [ ] Install Recharts library
  - [ ] `recharts`
- [ ] Create response time distribution chart
  - [ ] Histogram of response times
  - [ ] X-axis: Time buckets (0-30s, 30-60s, 1-2min, etc.)
  - [ ] Y-axis: Number of responses
  - [ ] Bar chart
- [ ] Create response type pie chart
  - [ ] Each response type as a slice
  - [ ] Color-coded
  - [ ] Show percentages
  - [ ] Show counts on hover
- [ ] Create level-by-level progress chart
  - [ ] Bar chart with levels on X-axis
  - [ ] Stacked bars: Responded vs Not Responded
  - [ ] Show progression through tree
- [ ] Add time-series view of responses (optional)
  - [ ] Line chart showing cumulative responses over time
  - [ ] X-axis: Time since notification sent
  - [ ] Y-axis: Number of responses

### 4.8 Real-time Subscription Management
- [ ] Create custom hook: `useRealtimeNotification`
  - [ ] Subscribe to notification updates
  - [ ] Handle subscription lifecycle
  - [ ] Cleanup on unmount
  - [ ] Return real-time data
- [ ] Implement connection status indicator
  - [ ] Show "Connected" / "Disconnected"
  - [ ] Show "Connecting..."
  - [ ] Reconnect automatically on disconnect
- [ ] Handle network errors gracefully
  - [ ] Fallback to polling if WebSocket fails
  - [ ] Show error message to user

### ðŸ§ª Stage 4 Testing:
- [ ] Send notification to 10+ users
- [ ] Watch real-time dashboard
- [ ] Submit responses from multiple mobile devices
- [ ] Verify instant update in web dashboard
- [ ] Verify tree visualization updates correctly
- [ ] Verify statistics calculations are accurate
- [ ] Test with multiple admins watching same notification
- [ ] Test non-responders list
- [ ] Export non-responders to CSV successfully
- [ ] Export responses to CSV successfully
- [ ] Test with slow network connection
- [ ] Test WebSocket reconnection
- [ ] Verify real-time updates are smooth (no lag)
- [ ] Test charts display correctly

### âœ… Stage 4 Deliverables:
- Real-time active notification dashboard
- Live tree visualization with status colors
- Response statistics and analytics
- Non-responders management
- Data export functionality (CSV)
- Real-time activity feed

---

## **STAGE 5: Calling Tree Cascade Logic** (Week 12-13)

### 5.1 Database Schema - Cascade Logic
- [ ] Create migration: `004_cascade_logic.sql`
  - [ ] Add to `tree_nodes` table:
    - [ ] `timeout_minutes` column
    - [ ] `backup_user_id` foreign key
    - [ ] `cascade_mode` enum (wait_for_all, wait_for_timeout)
  - [ ] Create `notification_cascade_status` table
    - [ ] Track current active level
    - [ ] Track level start time
    - [ ] Track level completion status
  - [ ] Create `cascade_events` table
    - [ ] Log all cascade events
    - [ ] Level transitions
    - [ ] Escalations
    - [ ] Timeouts
- [ ] Update RLS policies for new tables
- [ ] Create indexes for performance
  - [ ] notification_cascade_status.notification_id
  - [ ] cascade_events.notification_id

### 5.2 Backend - Cascade Engine Core
- [ ] Create database function: `get_next_level_recipients`
  - [ ] Input: notification_id, current_level
  - [ ] Get tree structure
  - [ ] Find users at current_level who should notify next level
  - [ ] Get their assigned contacts (children in tree)
  - [ ] Handle backup logic if primary timed out
  - [ ] Return list of user_ids to notify
- [ ] Create database function: `check_level_completion`
  - [ ] Input: notification_id, level
  - [ ] Check if all users at level responded OR timed out
  - [ ] Return boolean: complete or not
  - [ ] Return completion reason (all_responded, timeout, mixed)
- [ ] Create Edge Function: `cascade-engine`
  - [ ] Get all active notifications
  - [ ] For each notification:
    1. Get current cascade status
    2. Get current active level
    3. Check if level is complete
    4. If complete, determine next level
    5. If next level exists, trigger notifications
    6. Update cascade status
    7. Log event
  - [ ] Handle errors gracefully
  - [ ] Log all actions

### 5.3 Backend - Timeout Detection
- [ ] Implement timeout detection in cascade-engine
  - [ ] For each recipient at current level
  - [ ] Check time since notification was sent
  - [ ] Compare against node timeout setting
  - [ ] If exceeded and no response, mark as timed out
  - [ ] Update recipient status in database
- [ ] Create database function: `detect_timeouts`
  - [ ] Input: notification_id, level
  - [ ] Find recipients who exceeded timeout
  - [ ] Mark as timed out
  - [ ] Return list of timed out users

### 5.4 Backend - Backup Contact Logic
- [ ] Implement backup contact handling
  - [ ] When primary contact times out
  - [ ] Look up backup_user_id from tree_nodes
  - [ ] If backup exists, notify backup user
  - [ ] Backup user notifies primary's contacts
  - [ ] Log backup activation
- [ ] Create database function: `activate_backup_contact`
  - [ ] Input: notification_id, primary_user_id
  - [ ] Find backup user
  - [ ] Create notification recipient for backup
  - [ ] Create special recipient records for backup's responsibility
  - [ ] Log event
  - [ ] Return backup_user_id

### 5.5 Backend - Level Cascade Triggering
- [ ] Modify `process-notification` function
  - [ ] After creating notification, create initial cascade status
  - [ ] Set current_level to 1
  - [ ] Record level start time
  - [ ] Only notify Level 1 initially
- [ ] Create database function: `trigger_next_level`
  - [ ] Input: notification_id, next_level
  - [ ] Get recipients for next level
  - [ ] Create recipient records
  - [ ] Call send-push-notifications
  - [ ] Update cascade status (current_level = next_level)
  - [ ] Record level start time
  - [ ] Log cascade event

### 5.6 Backend - Escalation Chain
- [ ] Implement escalation logic
  - [ ] If entire level times out (no responses)
  - [ ] Escalate to department admin
  - [ ] Escalate to organization admin
  - [ ] Log escalation reason and path
- [ ] Create database function: `escalate_level`
  - [ ] Input: notification_id, level
  - [ ] Determine escalation target
  - [ ] Create notification for escalation target
  - [ ] Log event
- [ ] Update `escalate-notification` Edge Function
  - [ ] Manual escalation trigger
  - [ ] Send immediate follow-up notification
  - [ ] Log escalation event
  - [ ] Update cascade status

### 5.7 Scheduled Job Setup
- [ ] Set up cron job to run cascade-engine
  - [ ] Option 1: Supabase pg_cron extension
    - [ ] Enable pg_cron in Supabase
    - [ ] Create cron job to call cascade-engine every 1 minute
  - [ ] Option 2: External cron service
    - [ ] Use cron-job.org or similar (free)
    - [ ] Set up HTTP endpoint that calls cascade-engine
    - [ ] Schedule every 1-2 minutes
  - [ ] Option 3: Database triggers (alternative)
    - [ ] Trigger on response insert
    - [ ] Check if level complete
    - [ ] Call Edge Function via HTTP request
- [ ] Test cron job execution
  - [ ] Verify cascade-engine runs on schedule
  - [ ] Check logs for errors
  - [ ] Monitor performance

### 5.8 Web - Cascade Configuration in Tree Builder
- [ ] Add timeout configuration to node editor
  - [ ] Minutes input field
  - [ ] Default value (e.g., 5 minutes)
  - [ ] Visual indication of timeout on node
  - [ ] Inherit from parent option
- [ ] Add backup contact assignment UI
  - [ ] Dropdown to select backup user
  - [ ] Search/filter users
  - [ ] Show backup indicator on node (small badge)
  - [ ] Show backup relationship in tree (dotted line)
- [ ] Add tree-level cascade settings
  - [ ] Cascade mode: Level-by-level vs All-at-once
  - [ ] Default timeout for all nodes
  - [ ] Auto-escalate enabled/disabled
  - [ ] Max cascade levels

### 5.9 Web - Cascade Monitoring UI
- [ ] Add cascade progress section to monitoring page
  - [ ] Current active level indicator
  - [ ] Level timeline view
  - [ ] Show levels: Completed, Active, Pending
  - [ ] Color-coded status
- [ ] Create cascade timeline visualization
  - [ ] Horizontal timeline
  - [ ] Milestone for each level
  - [ ] Show when level started
  - [ ] Show when level completed
  - [ ] Show escalations/timeouts as events
  - [ ] Predicted next level time
- [ ] Build cascade events log viewer
  - [ ] Table of cascade events
  - [ ] Timestamp, event type, level, details
  - [ ] Filter by event type
  - [ ] Search functionality
  - [ ] Export to CSV

### 5.10 Testing Infrastructure for Cascade
- [ ] Create test helper UI (admin only)
  - [ ] Mock notification without actual push
  - [ ] Adjust timeout to seconds (for testing)
  - [ ] Simulate responses
  - [ ] Simulate timeouts
  - [ ] Fast-forward time (for testing)
- [ ] Create test scenarios
  - [ ] Scenario 1: Normal cascade (all respond)
  - [ ] Scenario 2: Timeout at level 1
  - [ ] Scenario 3: Backup activation
  - [ ] Scenario 4: Full tree cascade (5 levels)
  - [ ] Scenario 5: Mixed responses and timeouts

### ðŸ§ª Stage 5 Testing:
- [ ] Create 3-level test tree with 9 users (1-3-9 structure)
- [ ] Set timeout to 2 minutes for testing
- [ ] Send notification
- [ ] Verify only Level 1 users notified initially
- [ ] Level 1 user responds
- [ ] Verify their Level 2 contacts are notified
- [ ] Wait for timeout (don't respond)
- [ ] Verify timeout detected and backup notified
- [ ] Backup user responds
- [ ] Verify backup's contacts are notified
- [ ] Complete full cascade through all levels
- [ ] Verify cascade status updates correctly
- [ ] Verify cascade events logged accurately
- [ ] Test with 5-level tree (longer cascade)
- [ ] Verify cascade-engine cron job runs on schedule
- [ ] Check cascade logs for any errors
- [ ] Test escalation when entire level times out

### âœ… Stage 5 Deliverables:
- Automatic level-by-level cascade working
- Timeout detection and handling
- Backup contact system functional
- Escalation logic implemented
- Cascade monitoring dashboard
- Detailed cascade event logs
- Cron job successfully triggering cascade engine

---

## **STAGE 6: Document & Resource Management** (Week 14-15)

### 6.1 Database Schema - Documents
- [ ] Create migration: `005_documents.sql`
  - [ ] `document_categories` table
  - [ ] `documents` table
  - [ ] `document_access_groups` table
  - [ ] `document_user_access` junction table
  - [ ] `maps` table (for floor plans)
  - [ ] `map_markers` table (points of interest on maps)
- [ ] Set up RLS policies for documents
  - [ ] Users can read documents they have access to
  - [ ] Only admins can upload/delete
  - [ ] Check group membership for access
- [ ] Create Supabase Storage bucket
  - [ ] Create "documents" bucket
  - [ ] Create "maps" bucket
  - [ ] Configure bucket permissions
  - [ ] Set max file size limits

### 6.2 Web - Document Library
- [ ] Create documents page
  - [ ] Accessible from main navigation
- [ ] Build document list view
  - [ ] Grid view with thumbnails
  - [ ] List view option (toggle)
  - [ ] Show document icon (based on file type)
  - [ ] Show name, size, uploaded date, uploaded by
  - [ ] Search documents by name
  - [ ] Filter by category
  - [ ] Sort options (name, date, size)
- [ ] Add pagination or infinite scroll

### 6.3 Web - Document Upload
- [ ] Create upload interface
  - [ ] "Upload Document" button
  - [ ] Drag-and-drop zone
  - [ ] Multiple file selection
  - [ ] File type validation (PDF, DOCX, XLSX, images)
  - [ ] File size validation (respect Supabase limits)
  - [ ] Upload progress indicator
- [ ] Build document metadata form
  - [ ] Document name (auto-populated from filename, editable)
  - [ ] Description
  - [ ] Category dropdown
  - [ ] Tags/keywords (multi-select or chips)
  - [ ] Access groups (who can see this document)
  - [ ] Save button
- [ ] Implement upload logic
  - [ ] Upload file to Supabase Storage
  - [ ] Generate thumbnail (for images/PDFs)
  - [ ] Create database record
  - [ ] Link file URL
  - [ ] Error handling (network, size limits)

### 6.4 Web - Document Management
- [ ] Create document detail view
  - [ ] Click document to open detail modal
  - [ ] Show all metadata
  - [ ] Preview panel (for images, PDFs)
  - [ ] Download button
  - [ ] Edit metadata button
  - [ ] Delete button (with confirmation)
- [ ] Implement document preview
  - [ ] Embed PDF viewer (PDF.js or browser native)
  - [ ] Image lightbox
  - [ ] Show "Cannot preview" for other types
- [ ] Build edit document form
  - [ ] Same as upload form
  - [ ] Replace file option (new version)
  - [ ] Version history (future)
- [ ] Implement delete functionality
  - [ ] Confirmation dialog
  - [ ] Delete from Storage
  - [ ] Delete from database
  - [ ] Check for references in notifications (warn user)

### 6.5 Web - Document Categories & Access Control
- [ ] Create category management
  - [ ] Add category
  - [ ] Edit category
  - [ ] Delete category
  - [ ] Assign color/icon to category
- [ ] Build access group management
  - [ ] Create access groups (e.g., "Finance Team", "All Staff")
  - [ ] Assign users to groups
  - [ ] Assign groups to documents
- [ ] Implement access enforcement
  - [ ] Check user's group membership
  - [ ] Filter document list by access
  - [ ] Hide documents user can't access
  - [ ] Show "Restricted" badge if no access

### 6.6 Web - Maps Management
- [ ] Create maps section (separate from documents or tab)
- [ ] Build map upload interface
  - [ ] Upload floor plans / site maps (images)
  - [ ] Map name, building, floor
  - [ ] Description
- [ ] Create interactive map viewer
  - [ ] Install Leaflet or similar: `react-leaflet`
  - [ ] Display uploaded map image
  - [ ] Pan and zoom
  - [ ] Pinch to zoom (touch)
- [ ] Add map marker functionality
  - [ ] Click map to add marker
  - [ ] Marker types: Exit, Assembly Point, First Aid, Fire Extinguisher, AED
  - [ ] Marker label/description
  - [ ] Edit/delete markers
  - [ ] Save markers to database
- [ ] Associate maps with departments/buildings
  - [ ] Show relevant map to user based on location

### 6.7 Backend - Document Storage Functions
- [ ] Create Edge Function: `upload-document`
  - [ ] Handle file upload to Supabase Storage
  - [ ] Generate unique filename
  - [ ] Create database record
  - [ ] Generate thumbnail for images (optional: use external service)
  - [ ] Return document metadata
- [ ] Create storage policies
  - [ ] Authenticated users can read files they have access to
  - [ ] Only admins can upload/delete
  - [ ] Check organization ownership
- [ ] Implement document access control
  - [ ] Function to check if user has access to document
  - [ ] Check user's group membership
  - [ ] Enforce in RLS policies

### 6.8 Mobile - Documents Library
- [ ] Create documents screen
  - [ ] Tab or section in app
  - [ ] List of documents with icons
  - [ ] Show name, size, category
  - [ ] Search bar
  - [ ] Category filter
  - [ ] Pull-to-refresh
- [ ] Implement document viewing
  - [ ] Tap document to open
  - [ ] PDF viewer: `react-native-pdf` or `expo-document-picker`
  - [ ] Image viewer: built-in Image component with zoom
  - [ ] Show "Cannot view on mobile" for unsupported types
  - [ ] Download button

### 6.9 Mobile - Offline Document Storage
- [ ] Implement download for offline
  - [ ] "Download for offline" button
  - [ ] Download file to device
  - [ ] Store file path in local database
  - [ ] Show "Downloaded" badge
- [ ] Create offline documents section
  - [ ] List of downloaded documents
  - [ ] Open from local storage
  - [ ] Delete offline copy option
- [ ] Implement sync management
  - [ ] Check for document updates
  - [ ] Re-download if new version
  - [ ] Show storage usage
  - [ ] Clear cache option

### 6.10 Mobile - Maps Viewer
- [ ] Create maps screen
  - [ ] List of available maps
  - [ ] Filter by building/location
- [ ] Build map viewer
  - [ ] Display map image
  - [ ] Pinch to zoom
  - [ ] Pan gesture
  - [ ] Show markers with icons
  - [ ] Tap marker to see details
- [ ] Implement offline map access
  - [ ] Download map images
  - [ ] Store locally
  - [ ] Available without internet

### 6.11 Notification Integration
- [ ] Add document attachment to notification creation
  - [ ] Multi-select documents in send notification form
  - [ ] Show attached documents in notification payload
  - [ ] Link documents in notification_documents junction table
- [ ] Mobile: Show attached documents in notification detail
  - [ ] List of attached documents
  - [ ] Tap to open/download
  - [ ] Quick access to evacuation maps during emergency

### ðŸ§ª Stage 6 Testing:
- [ ] Upload PDF document via web
- [ ] Upload image document via web
- [ ] View PDF in web preview
- [ ] Download document from web
- [ ] View document list on mobile
- [ ] Open PDF on mobile (Android)
- [ ] Open PDF on mobile (iOS)
- [ ] Download document for offline access
- [ ] Open offline document with no internet
- [ ] Upload floor plan map
- [ ] Add markers to map (exits, assembly points)
- [ ] View map on mobile with zoom
- [ ] Send notification with attached document
- [ ] Open attached document from notification on mobile
- [ ] Test document access control (user can't access restricted doc)
- [ ] Delete document successfully
- [ ] Test storage limits (large file upload)

### âœ… Stage 6 Deliverables:
- Document upload and management system
- Mobile document viewer with offline support
- Maps management and interactive viewer
- Document access control by groups
- Document attachment to notifications
- Offline map access on mobile

---

## **STAGE 7: Advanced Features & Polish** (Week 16-18)

### 7.1 Message Templates
- [ ] Create database migration: `006_advanced_features.sql`
  - [ ] `message_templates` table
- [ ] Web: Build templates management page
  - [ ] List of saved templates
  - [ ] Create template button
- [ ] Web: Create template form
  - [ ] Template name, description
  - [ ] Pre-written title and body
  - [ ] Default priority/type
  - [ ] Response options
  - [ ] Placeholders: {{user_name}}, {{current_time}}, {{location}}
  - [ ] Save button
- [ ] Web: Integrate templates into send notification
  - [ ] "Use Template" dropdown
  - [ ] Load template data into form
  - [ ] Replace placeholders with actual values
  - [ ] Allow editing after loading
- [ ] Implement quick-send from template
  - [ ] "Quick Send" button on template
  - [ ] Select tree and send immediately
  - [ ] Minimal confirmation

### 7.2 Notification Scheduling
- [ ] Database: Add to notifications table
  - [ ] `scheduled_at` timestamp column
  - [ ] `status` enum (draft, scheduled, sent, cancelled)
- [ ] Web: Add scheduling to notification creation
  - [ ] "Send Now" vs "Schedule" toggle
  - [ ] Date/time picker
  - [ ] Timezone selector
  - [ ] Recurring schedule option (for drills)
  - [ ] Recurrence pattern (daily, weekly, monthly)
- [ ] Web: Create scheduled notifications list
  - [ ] Show upcoming scheduled notifications
  - [ ] Sort by scheduled time
  - [ ] Edit scheduled notification
  - [ ] Cancel scheduled notification
- [ ] Backend: Implement scheduled sending
  - [ ] Cron job to check for scheduled notifications
  - [ ] Send notifications at scheduled time
  - [ ] Handle recurring notifications
  - [ ] Log scheduled sends

### 7.3 Advanced Analytics Dashboard
- [ ] Web: Create analytics page
  - [ ] Accessible from main navigation
- [ ] Build overall statistics panel
  - [ ] Total notifications sent (time period selector)
  - [ ] Total users
  - [ ] Average response time
  - [ ] Response rate
  - [ ] Most used trees
  - [ ] Most used notification types
- [ ] Create notification trends chart
  - [ ] Line chart: Notifications sent over time
  - [ ] Bar chart: Notifications by type
  - [ ] Bar chart: Notifications by day of week
- [ ] Build user engagement metrics
  - [ ] Table: Top responders (fastest, most engaged)
  - [ ] Table: Slow responders
  - [ ] Table: Non-responsive users (never responded)
  - [ ] Department comparison chart
- [ ] Create drill performance tracking
  - [ ] Filter by notification type = "Test"
  - [ ] Compare drill results over time
  - [ ] Show improvement metrics
  - [ ] Response time trends
  - [ ] Compliance rate
- [ ] Add export functionality
  - [ ] Export charts as PNG
  - [ ] Export data as CSV/Excel
  - [ ] Generate PDF report

### 7.4 Audit Logs
- [ ] Database: Create audit_logs table (if not exists)
  - [ ] Columns: timestamp, user_id, action, resource_type, resource_id, details, ip_address
- [ ] Backend: Implement audit logging
  - [ ] Log user logins
  - [ ] Log tree create/edit/delete
  - [ ] Log notification sends
  - [ ] Log user management actions
  - [ ] Log settings changes
  - [ ] Log document uploads/deletes
- [ ] Web: Create audit log viewer page
  - [ ] Table of audit logs
  - [ ] Columns: Timestamp, User, Action, Resource, Details
  - [ ] Search by user
  - [ ] Filter by action type
  - [ ] Filter by date range
  - [ ] Pagination
  - [ ] Export to CSV
- [ ] Implement log retention policy
  - [ ] Archive old logs (e.g., > 1 year)
  - [ ] Automated cleanup job

### 7.5 Organization Settings
- [ ] Web: Create organization settings page
  - [ ] Accessible from settings menu
- [ ] Build organization profile section
  - [ ] Organization name
  - [ ] Logo upload (Supabase Storage)
  - [ ] Contact information
  - [ ] Address
  - [ ] Timezone
  - [ ] Save button
- [ ] Create notification default settings
  - [ ] Default timeout value (minutes)
  - [ ] Retry attempts for failed push notifications
  - [ ] Escalation rules (enable/disable)
  - [ ] Auto-cascade vs manual
- [ ] Build appearance settings (basic branding)
  - [ ] Primary color picker
  - [ ] Secondary color picker
  - [ ] Logo display in app (web and mobile)
  - [ ] Preview changes
- [ ] Create data retention settings
  - [ ] Notification retention period (days)
  - [ ] Archive old notifications option
  - [ ] GDPR compliance tools (data export, deletion)

### 7.6 Mobile - User Preferences
- [ ] Enhance settings screen
- [ ] Build notification preferences section
  - [ ] Enable/disable notification types
  - [ ] Quiet hours (start time, end time)
  - [ ] Notification sound selection
  - [ ] Vibration enabled/disabled
- [ ] Create privacy settings section
  - [ ] Location sharing preference (always, ask, never)
  - [ ] Profile visibility (visible to all, admins only)
  - [ ] Data collection consent
- [ ] Add app preferences section
  - [ ] Theme: Light, Dark, System Default
  - [ ] Language selection (if multi-language)
  - [ ] Default home screen
- [ ] Implement Do Not Disturb mode
  - [ ] Toggle to enable DND
  - [ ] Set time-bound DND (end time)
  - [ ] Emergency notifications override option
  - [ ] Show DND indicator in app

### 7.7 Mobile - Onboarding Tutorial
- [ ] Create onboarding screens
  - [ ] Welcome screen with app logo and tagline
  - [ ] Screen 1: Explain calling tree concept
  - [ ] Screen 2: How to respond to notifications
  - [ ] Screen 3: Access emergency resources
  - [ ] Screen 4: Request permissions
  - [ ] Swipeable carousel
- [ ] Implement skip and next buttons
- [ ] Show only on first app launch
- [ ] Add "Show tutorial again" in settings
- [ ] Request permissions with context
  - [ ] Explain why notifications are needed
  - [ ] Explain why location might be needed

### 7.8 Mobile - UI/UX Polish
- [ ] Add empty states to all screens
  - [ ] No notifications yet (with illustration)
  - [ ] No documents available
  - [ ] No internet connection
  - [ ] Helpful messaging and actions
- [ ] Implement loading states
  - [ ] Skeleton screens for lists
  - [ ] Shimmer effects
  - [ ] Smooth transitions between screens
  - [ ] Loading spinners where appropriate
- [ ] Improve error handling
  - [ ] User-friendly error messages
  - [ ] Retry buttons for failed actions
  - [ ] Offline mode indicator (banner)
  - [ ] Toast notifications for success/error
- [ ] Add haptic feedback
  - [ ] Button presses
  - [ ] Critical alerts
  - [ ] Response submission
- [ ] Optimize performance
  - [ ] Lazy load images
  - [ ] Virtualized lists for long scrolling
  - [ ] Reduce bundle size (analyze with `expo-bundle-analyzer`)
  - [ ] Optimize re-renders

### 7.9 Web - UI/UX Polish
- [ ] Implement responsive design refinement
  - [ ] Mobile web view (< 768px)
  - [ ] Tablet view (768px - 1024px)
  - [ ] Desktop view (> 1024px)
  - [ ] Test on various screen sizes
- [ ] Add loading states and skeletons
  - [ ] Skeleton loaders for tables and lists
  - [ ] Loading spinners for actions
  - [ ] Progress bars for long operations
- [ ] Implement error boundaries
  - [ ] Catch React errors
  - [ ] Show friendly error page
  - [ ] Log errors to monitoring service
- [ ] Add toast notifications
  - [ ] Success messages (green)
  - [ ] Error messages (red)
  - [ ] Info messages (blue)
  - [ ] Warning messages (orange)
  - [ ] Auto-dismiss after 5 seconds
- [ ] Create confirmation dialogs
  - [ ] Delete actions
  - [ ] Destructive actions
  - [ ] Send notification (final confirmation)
- [ ] Add keyboard shortcuts (power users)
  - [ ] Ctrl+K: Quick search
  - [ ] N: New notification
  - [ ] T: New tree
  - [ ] ?: Show shortcuts help
- [ ] Implement dark mode
  - [ ] Toggle in user menu
  - [ ] Persist preference
  - [ ] All pages support dark mode
  - [ ] Smooth transition

### 7.10 Accessibility Improvements
- [ ] Web: WCAG 2.1 AA compliance
  - [ ] Add ARIA labels to interactive elements
  - [ ] Keyboard navigation support
  - [ ] Focus indicators
  - [ ] Skip to main content link
  - [ ] Color contrast check (use WAVE or axe)
  - [ ] Form labels properly associated
  - [ ] Alt text for images
- [ ] Mobile: Accessibility features
  - [ ] Screen reader support (TalkBack, VoiceOver)
  - [ ] Accessibility labels for buttons
  - [ ] Sufficient touch target sizes (min 44x44)
  - [ ] Color contrast compliance
  - [ ] Support for system text size

### 7.11 Performance Optimization
- [ ] Database optimization
  - [ ] Review and add indexes to slow queries
  - [ ] Optimize complex queries (EXPLAIN ANALYZE)
  - [ ] Consider materialized views for analytics
  - [ ] Database connection pooling (Supabase handles this)
- [ ] Web: Frontend optimization
  - [ ] Code splitting (React.lazy)
  - [ ] Lazy load routes
  - [ ] Optimize images (compression, WebP format)
  - [ ] Bundle size analysis (vite-bundle-visualizer)
  - [ ] Remove unused dependencies
  - [ ] Tree shaking
- [ ] API optimization
  - [ ] Implement caching headers
  - [ ] Pagination for large lists (limit/offset)
  - [ ] Batch requests where possible
  - [ ] Debounce search inputs
- [ ] Mobile: Performance optimization
  - [ ] Reduce app size (remove unused assets)
  - [ ] Optimize image assets (compressed)
  - [ ] Minimize API calls (cache data)
  - [ ] Use FlatList instead of ScrollView for long lists
  - [ ] Implement memoization (React.memo)

### ðŸ§ª Stage 7 Testing:
- [ ] Create message template and use it to send notification
- [ ] Schedule notification for 5 minutes in future
- [ ] Verify scheduled notification sends automatically
- [ ] View analytics dashboard with real data
- [ ] Export analytics report to PDF
- [ ] View audit logs and search by user
- [ ] Update organization settings (logo, colors)
- [ ] Complete onboarding tutorial on mobile
- [ ] Set notification preferences on mobile (quiet hours)
- [ ] Enable Do Not Disturb mode and verify behavior
- [ ] Test dark mode on web
- [ ] Test keyboard shortcuts on web
- [ ] Test accessibility with screen reader (web and mobile)
- [ ] Test app with slow network (throttled to 3G)
- [ ] Verify app feels fast and responsive
- [ ] Check bundle sizes (web and mobile)

### âœ… Stage 7 Deliverables:
- Message templates system
- Notification scheduling and recurring notifications
- Advanced analytics dashboard with charts
- Audit logging and viewer
- Organization settings and customization
- User preferences on mobile (DND, quiet hours)
- Onboarding tutorial
- Polished UI/UX with loading states, empty states, error handling
- Dark mode support
- Accessibility compliance
- Performance optimizations

---

## **STAGE 8: Testing, Bug Fixes & Deployment Prep** (Week 19-20)

### 8.1 Comprehensive Testing
- [ ] **Functional Testing**
  - [ ] Test all user flows end-to-end as different roles
  - [ ] Super Admin flow
  - [ ] Org Admin flow
  - [ ] Standard User flow
  - [ ] Test all CRUD operations
  - [ ] Test edge cases (empty states, max limits, boundary values)
  - [ ] Test error scenarios (network errors, validation errors)
- [ ] **Integration Testing**
  - [ ] Complete notification flow: Create â†’ Send â†’ Receive â†’ Respond â†’ Track
  - [ ] Cascade logic with real timing (use shorter timeouts)
  - [ ] Multiple concurrent notifications
  - [ ] Document upload and access
  - [ ] Real-time updates across multiple browser windows
- [ ] **Mobile Testing - iOS**
  - [ ] Test on iPhone (latest iOS)
  - [ ] Test on iPad
  - [ ] Test on older iOS version (iOS 14+)
  - [ ] Test push notifications on physical device
  - [ ] Background notification handling
  - [ ] App lifecycle (minimize, restore, kill, reopen)
  - [ ] Biometric authentication
- [ ] **Mobile Testing - Android**
  - [ ] Test on Android phone (latest Android)
  - [ ] Test on Android tablet
  - [ ] Test on older Android version (Android 10+)
  - [ ] Test push notifications on physical device
  - [ ] Background notification handling
  - [ ] App lifecycle
  - [ ] Fingerprint authentication
  - [ ] Test on different manufacturers (Samsung, Google Pixel)
- [ ] **Cross-browser Testing (Web)**
  - [ ] Chrome (desktop and mobile)
  - [ ] Firefox (desktop and mobile)
  - [ ] Safari (desktop and mobile)
  - [ ] Edge (desktop)
- [ ] **Performance Testing**
  - [ ] Load testing: 100+ concurrent users
  - [ ] Stress test: Send notification to 500+ users
  - [ ] Database performance with large datasets
  - [ ] Mobile app performance profiling
  - [ ] Web page load times (< 3 seconds)
  - [ ] API response times (< 500ms for most endpoints)
- [ ] **Security Testing**
  - [ ] Test RLS policies thoroughly (try to bypass)
  - [ ] Attempt unauthorized access to resources
  - [ ] Test authentication flows (try to break)
  - [ ] SQL injection attempts (Supabase protects, but test)
  - [ ] XSS attempts
  - [ ] CSRF protection
  - [ ] Test data encryption at rest and in transit

### 8.2 Bug Tracking & Fixing
- [ ] Set up bug tracking system
  - [ ] Use GitHub Issues with labels
  - [ ] Labels: bug, critical, high, medium, low, enhancement
- [ ] Create bug template
  - [ ] Description, steps to reproduce, expected vs actual
- [ ] Triage bugs by priority
  - [ ] Critical: Auth issues, notifications not sending, data loss
  - [ ] High: UI broken, performance issues, major features not working
  - [ ] Medium: Minor UI issues, edge cases, nice-to-haves
  - [ ] Low: Cosmetic issues, typos
- [ ] Fix critical bugs first
  - [ ] Security vulnerabilities
  - [ ] Authentication failures
  - [ ] Notification delivery failures
  - [ ] Data corruption issues
- [ ] Fix high priority bugs
  - [ ] Major UI problems
  - [ ] Performance issues
  - [ ] Important features not working
- [ ] Address medium/low bugs as time permits
- [ ] Regression testing after each fix
  - [ ] Verify bug is fixed
  - [ ] Ensure fix didn't break anything else

### 8.3 Documentation
- [ ] **User Documentation**
  - [ ] Admin user guide
    - [ ] How to create calling trees
    - [ ] How to send notifications
    - [ ] How to manage users
    - [ ] How to manage documents
    - [ ] How to view reports
  - [ ] End user guide
    - [ ] How to use mobile app
    - [ ] How to respond to notifications
    - [ ] How to access documents
    - [ ] How to update profile
  - [ ] Quick start guides (one-pagers)
  - [ ] FAQ document
  - [ ] Video tutorials (optional but recommended)
- [ ] **Technical Documentation**
  - [ ] System architecture document (use BLUEPRINT.md)
  - [ ] Database schema documentation with ER diagram
  - [ ] API documentation (generate with OpenAPI/Swagger)
  - [ ] Deployment guide (step-by-step)
  - [ ] Environment variables documentation
  - [ ] Backup and recovery procedures
- [ ] **README Files**
  - [ ] Main README.md
    - [ ] Project overview
    - [ ] Features list
    - [ ] Technology stack
    - [ ] Getting started
    - [ ] License
  - [ ] /web/README.md - Web app setup
  - [ ] /mobile/README.md - Mobile app setup
  - [ ] /backend/README.md - Backend setup

### 8.4 Deployment Preparation
- [ ] **Supabase Production Setup**
  - [ ] Create production Supabase project (free tier)
  - [ ] Run all database migrations in order
  - [ ] Seed production data (roles, default settings)
  - [ ] Configure production OAuth credentials
    - [ ] Apple Sign In (production)
    - [ ] Google Sign In (production)
  - [ ] Set up production environment variables
  - [ ] Configure custom domain (optional)
  - [ ] Enable database backups
  - [ ] Set up monitoring and alerts in Supabase dashboard
- [ ] **Web Deployment**
  - [ ] Choose hosting platform (Vercel or Netlify free tier)
  - [ ] Connect GitHub repository
  - [ ] Configure build settings
    - [ ] Build command: `npm run build`
    - [ ] Output directory: `dist`
  - [ ] Set environment variables in hosting platform
    - [ ] VITE_SUPABASE_URL
    - [ ] VITE_SUPABASE_ANON_KEY
  - [ ] Set up CI/CD pipeline (auto-deploy on push to main)
  - [ ] Configure custom domain (if available)
  - [ ] Set up SSL certificate (automatic with Vercel/Netlify)
  - [ ] Test production deployment
    - [ ] Visit deployed URL
    - [ ] Test login
    - [ ] Test core functionality
- [ ] **Mobile Deployment Prep**
  - [ ] Update app.json with production values
    - [ ] App name
    - [ ] Bundle identifier / Package name
    - [ ] Version number (1.0.0)
    - [ ] Build number (1)
    - [ ] Splash screen
    - [ ] App icon
  - [ ] Create app icons and splash screens (all required sizes)
    - [ ] Use Figma or similar to design
    - [ ] Export all sizes (iOS and Android)
    - [ ] Or use `npx expo-app-icon` tool
  - [ ] Configure app signing
    - [ ] iOS: Create distribution certificate and provisioning profile
    - [ ] Android: Generate upload keystore
  - [ ] Build production versions
    - [ ] iOS: `eas build --platform ios`
    - [ ] Android: `eas build --platform android`
  - [ ] Test production builds on physical devices
    - [ ] Install IPA on iOS device
    - [ ] Install APK/AAB on Android device
    - [ ] Test full functionality

### 8.5 App Store Submission Preparation
- [ ] **Apple App Store (iOS)**
  - [ ] Create App Store Connect account (requires Apple Developer Program $99/year)
  - [ ] Create app record in App Store Connect
  - [ ] Prepare app metadata
    - [ ] App name (unique)
    - [ ] Subtitle (short tagline)
    - [ ] Description (4000 characters)
    - [ ] Keywords (100 characters, comma-separated)
    - [ ] Support URL
    - [ ] Marketing URL (optional)
  - [ ] Prepare screenshots (all required sizes)
    - [ ] 6.5" iPhone (1242 x 2688)
    - [ ] 5.5" iPhone (1242 x 2208)
    - [ ] iPad Pro 12.9" (2048 x 2732)
    - [ ] Use Figma or Screenshot Frames app
  - [ ] Create app preview video (optional, recommended)
  - [ ] Create privacy policy URL (required)
    - [ ] Host on website or GitHub Pages
  - [ ] Complete App Store questionnaire
    - [ ] Age rating
    - [ ] Content rights
    - [ ] Export compliance
  - [ ] Submit build for TestFlight
    - [ ] Upload build via Xcode or eas submit
    - [ ] Distribute to internal testers
  - [ ] Complete App Review Information
    - [ ] Demo account credentials
    - [ ] Notes for reviewer
- [ ] **Google Play Store (Android)**
  - [ ] Create Google Play Console account ($25 one-time)
  - [ ] Create app in Google Play Console
  - [ ] Prepare store listing
    - [ ] App name (unique, max 30 characters)
    - [ ] Short description (80 characters)
    - [ ] Full description (4000 characters)
    - [ ] Feature graphic (1024 x 500)
    - [ ] Screenshots (all required)
      - [ ] Phone: 16:9 (1920 x 1080) min 2 screenshots
      - [ ] 7-inch tablet (optional)
      - [ ] 10-inch tablet (optional)
  - [ ] Create privacy policy URL (required)
  - [ ] Complete content rating questionnaire
    - [ ] IARC rating certificate
  - [ ] Set up app categories and tags
  - [ ] Create app release
    - [ ] Internal testing track first
    - [ ] Upload signed APK or AAB
    - [ ] Release notes
  - [ ] Complete Data safety section
    - [ ] Data collection and usage
    - [ ] Security practices

### 8.6 Beta Testing
- [ ] Recruit 5-10 beta testers
  - [ ] Mix of roles (admins and standard users)
  - [ ] Variety of devices (iOS and Android)
- [ ] Distribute beta builds
  - [ ] iOS: TestFlight invite links
  - [ ] Android: Google Play internal testing invite
- [ ] Create feedback channels
  - [ ] Google Form or Typeform for feedback
  - [ ] Email for bug reports
  - [ ] Set up Slack channel or Discord (optional)
- [ ] Provide testing instructions
  - [ ] What to test
  - [ ] How to provide feedback
  - [ ] Timeline (1-2 weeks)
- [ ] Run organized test scenarios
  - [ ] Emergency drill simulation
  - [ ] Have testers respond
  - [ ] Collect feedback
- [ ] Collect and analyze feedback
  - [ ] Bug reports â†’ GitHub Issues
  - [ ] Feature requests â†’ backlog
  - [ ] UX issues â†’ prioritize fixes
- [ ] Implement critical feedback
  - [ ] Fix blocking issues
  - [ ] Improve confusing UX
- [ ] Release updated beta build if needed

### 8.7 Monitoring & Analytics Setup
- [ ] Set up error tracking
  - [ ] Web: Integrate Sentry (free tier)
  - [ ] Mobile: Integrate Sentry (free tier)
  - [ ] Configure source maps for better error traces
- [ ] Set up analytics
  - [ ] Web: Plausible Analytics or Google Analytics
  - [ ] Mobile: Expo Analytics or Firebase Analytics
  - [ ] Track key events (signup, login, notification sent, response)
  - [ ] Respect user privacy (GDPR compliant)
- [ ] Set up uptime monitoring
  - [ ] Use UptimeRobot (free tier, 50 monitors)
  - [ ] Monitor web app URL
  - [ ] Monitor API health endpoint
  - [ ] Set up email alerts for downtime
- [ ] Set up logging
  - [ ] Centralized logging (Supabase logs + external)
  - [ ] Log levels (error, warn, info, debug)
  - [ ] Log retention policy
- [ ] Create monitoring dashboard
  - [ ] Supabase Dashboard for database metrics
  - [ ] Vercel/Netlify dashboard for web metrics
  - [ ] Sentry dashboard for errors
  - [ ] UptimeRobot dashboard for uptime

### 8.8 Final Checks
- [ ] **Security Audit**
  - [ ] Review all RLS policies
  - [ ] Check for exposed secrets (use git-secrets)
  - [ ] Verify HTTPS everywhere
  - [ ] Check CORS settings
  - [ ] Verify JWT token expiration
  - [ ] Password policy enforcement
  - [ ] Rate limiting on sensitive endpoints
- [ ] **Performance Benchmarks**
  - [ ] Web page load time < 3 seconds
  - [ ] API response time < 500ms
  - [ ] Mobile app launch time < 2 seconds
  - [ ] Notification delivery time < 5 seconds
  - [ ] Real-time update latency < 1 second
- [ ] **Database Backup Strategy**
  - [ ] Supabase automatic backups enabled
  - [ ] Test restore from backup
  - [ ] Document restore procedure
- [ ] **Disaster Recovery Plan**
  - [ ] Document recovery steps
  - [ ] Contact list for emergencies
  - [ ] Backup access credentials (secure vault)
- [ ] **Legal Documents**
  - [ ] Terms of Service document created and hosted
  - [ ] Privacy Policy document created and hosted
  - [ ] GDPR compliance checklist completed
  - [ ] Data processing agreement (if needed)
- [ ] **Accessibility Audit**
  - [ ] Run WAVE or axe accessibility checker
  - [ ] Fix critical accessibility issues
  - [ ] Test with screen reader
  - [ ] Verify keyboard navigation

### ðŸ§ª Stage 8 Final Testing Checklist:
- [ ] All critical bugs resolved
- [ ] Zero authentication/authorization issues
- [ ] Push notifications 100% reliable on all devices
- [ ] Successfully complete full emergency drill simulation with 20+ users
- [ ] Tested on 5+ different iOS devices/versions
- [ ] Tested on 5+ different Android devices/versions
- [ ] Web portal works flawlessly on Chrome, Firefox, Safari, Edge
- [ ] Load test passed: 100+ concurrent users, system stable
- [ ] All documentation complete and reviewed
- [ ] Beta testers report positive feedback (>80% satisfaction)
- [ ] Production deployment successful
- [ ] No critical security vulnerabilities
- [ ] Performance benchmarks met

### âœ… Stage 8 Deliverables:
- Stable, thoroughly tested application
- All critical and high-priority bugs fixed
- Complete user and technical documentation
- Production environment deployed and tested
- Mobile apps built and ready for submission
- App store listings prepared
- Beta testing completed with positive feedback
- Monitoring and analytics operational
- Security audit passed
- Performance benchmarks met

---

## **STAGE 9: Launch & Post-Launch** (Week 21+)

### 9.1 Soft Launch
- [ ] Deploy web portal to production (if not already done)
- [ ] Release mobile apps to limited audience (TestFlight/Internal Testing)
- [ ] Announce soft launch to initial users/organization
- [ ] Monitor error rates closely (check Sentry hourly)
- [ ] Monitor Supabase usage metrics daily
- [ ] Monitor app performance (response times, load times)
- [ ] Set up on-call rotation or monitoring schedule
- [ ] Quick response to any issues (within 1 hour)
- [ ] Collect early feedback from users
- [ ] Make hotfixes if needed

### 9.2 Public Launch (App Store Submission)
- [ ] **iOS App Store Submission**
  - [ ] Submit app for review in App Store Connect
  - [ ] Select release option (manual or automatic)
  - [ ] Monitor review status
  - [ ] Respond to any reviewer questions
  - [ ] Expected review time: 1-3 days
  - [ ] Once approved, release to public
- [ ] **Google Play Store Submission**
  - [ ] Submit app for review in Google Play Console
  - [ ] Promote from internal/closed testing to production
  - [ ] Monitor review status
  - [ ] Respond to any reviewer questions
  - [ ] Expected review time: 1-7 days
  - [ ] Once approved, release to public
- [ ] Create launch announcement
  - [ ] Blog post
  - [ ] Social media posts
  - [ ] Email to waitlist (if any)
- [ ] Update website/landing page with app store links
- [ ] Prepare customer support channels
  - [ ] Support email
  - [ ] FAQ page
  - [ ] Live chat (optional)

### 9.3 User Onboarding & Support
- [ ] Create comprehensive help center
  - [ ] FAQs
  - [ ] How-to articles
  - [ ] Video tutorials (screen recordings)
  - [ ] Troubleshooting guides
- [ ] Set up support email and ticketing system
  - [ ] Email: support@calltree.app (example)
  - [ ] Use Help Scout or Zendesk (free tier) or simple email
- [ ] Create user community (optional)
  - [ ] Discord server or Slack community
  - [ ] Forum or discussion board
  - [ ] User-to-user support
- [ ] Offer demo/training sessions
  - [ ] Live demo webinars
  - [ ] One-on-one onboarding calls for enterprise customers
  - [ ] Recorded training videos
- [ ] Create user onboarding email sequence
  - [ ] Welcome email
  - [ ] Getting started guide
  - [ ] Tips and tricks
  - [ ] Feature highlights

### 9.4 Monitoring & Iteration
- [ ] **Daily Monitoring (First Week)**
  - [ ] Check error rates in Sentry (aim for <0.1% error rate)
  - [ ] Check push notification delivery rates (aim for >98%)
  - [ ] Monitor user signups and activations
  - [ ] Check Supabase usage metrics (database, storage, bandwidth)
  - [ ] Monitor app store ratings and reviews
  - [ ] Respond to app store reviews
- [ ] **Weekly Reviews (First Month)**
  - [ ] Analyze user feedback and support tickets
  - [ ] Identify common pain points and issues
  - [ ] Review analytics (user engagement, feature usage)
  - [ ] Prioritize improvements and bug fixes
  - [ ] Plan weekly releases for bug fixes
- [ ] **Monthly Reviews (Ongoing)**
  - [ ] Review overall system performance and health
  - [ ] Analyze user growth and retention
  - [ ] Review Supabase costs (if approaching limits)
  - [ ] Plan major feature updates
  - [ ] Review security and compliance

### 9.5 Continuous Improvement
- [ ] **Bug Fix Releases**
  - [ ] Weekly or bi-weekly bug fix releases
  - [ ] Patch critical bugs immediately (hotfix)
  - [ ] Test thoroughly before release
  - [ ] Communicate fixes to users
- [ ] **Feature Updates**
  - [ ] Monthly or quarterly feature releases
  - [ ] Prioritize based on user feedback
  - [ ] Maintain backlog of feature requests
  - [ ] Announce new features (changelog, email)
- [ ] **Performance Improvements**
  - [ ] Continuously optimize slow queries
  - [ ] Reduce bundle sizes
  - [ ] Improve app launch time
  - [ ] Optimize notification delivery

### 9.6 Post-Launch Features (Backlog Ideas)
- [ ] Multi-language support (i18n)
- [ ] Advanced reporting and exports
- [ ] SMS fallback notifications (paid feature, via Twilio)
- [ ] Voice call integration (paid feature, via Twilio)
- [ ] Geofencing and location-based alerts
- [ ] Integration with third-party systems (HR, Active Directory)
- [ ] Webhooks for external integrations
- [ ] White-labeling options (custom branding per org)
- [ ] Multi-tenant architecture (support multiple organizations)
- [ ] Advanced AI insights (predict response times, identify patterns)
- [ ] Mobile app widgets
- [ ] Apple Watch / Wear OS support
- [ ] Offline mode improvements (full offline functionality)
- [ ] Two-way communication (users can message back)
- [ ] Video/image sharing in responses
- [ ] Emergency contact auto-calling
- [ ] Integration with IoT sensors (fire alarms, security systems)

### 9.7 Scaling Considerations
- [ ] Monitor Supabase free tier limits
  - [ ] If approaching 500 MB database, consider Pro tier ($25/month)
  - [ ] If approaching 5 GB bandwidth, optimize or upgrade
  - [ ] If approaching 1 GB storage, clean up old files or upgrade
- [ ] Optimize database for scale
  - [ ] Add indexes for slow queries
  - [ ] Archive old notifications (>90 days)
  - [ ] Consider partitioning large tables
- [ ] Consider CDN for static assets
  - [ ] Cloudflare free tier
  - [ ] Serve images, documents from CDN
- [ ] Plan for high-availability (if needed)
  - [ ] Database replicas
  - [ ] Load balancing
  - [ ] Failover strategies

### 9.8 Marketing & Growth (Optional)
- [ ] Create product website/landing page
- [ ] SEO optimization
- [ ] Content marketing (blog posts about emergency preparedness)
- [ ] Social media presence
- [ ] Product Hunt launch
- [ ] Reach out to emergency management communities
- [ ] Partnerships with schools, hospitals, corporations
- [ ] Freemium model (free tier + paid features)

### âœ… Stage 9 Deliverables:
- Successful soft launch with positive initial feedback
- Apps published on App Store and Google Play
- Support infrastructure in place
- Active monitoring and quick response to issues
- User feedback loop established
- Regular updates and improvements planned
- Scalable infrastructure for growth

---

## ðŸŽ¯ Development Milestones Summary

| Milestone | Week | Description |
|-----------|------|-------------|
| **Environment Ready** | 1 | All projects set up, Supabase configured |
| **Auth Working** | 3 | Users can sign up and log in |
| **Trees Built** | 6 | Visual tree builder functional |
| **Notifications Sent** | 9 | Push notifications delivered |
| **Real-Time Tracking** | 11 | Live dashboard operational |
| **Auto-Cascade Working** | 13 | Level-by-level cascade functional |
| **MVP Complete** | 13 | Core features complete and working |
| **Documents Added** | 15 | Document management operational |
| **Full Feature Set** | 18 | All advanced features complete |
| **Production Ready** | 20 | Tested, documented, deployed |
| **Launched** | 21+ | Apps in stores, users onboarded |

---

## ðŸ“ˆ Success Metrics

Track these metrics post-launch:

### User Metrics:
- [ ] Total users registered
- [ ] Daily active users (DAU)
- [ ] Monthly active users (MAU)
- [ ] User retention rate
- [ ] App store ratings (target: >4.5 stars)

### System Performance:
- [ ] Push notification delivery rate (target: >98%)
- [ ] Average notification response time (target: <2 minutes)
- [ ] System uptime (target: >99.9%)
- [ ] API response time (target: <500ms)
- [ ] Error rate (target: <0.1%)

### Engagement:
- [ ] Notifications sent per week
- [ ] Average response rate (target: >90%)
- [ ] Document downloads
- [ ] Active calling trees
- [ ] Drill participation rate

---

## ðŸ’° Budget Tracker

Monitor costs during and after launch:

### Development Phase (Free Tier):
- Supabase: $0
- Vercel/Netlify: $0
- GitHub: $0
- Total: $0

### Required Costs:
- Apple Developer: $99/year
- Google Play: $25 one-time
- Domain (optional): $12/year
- **Total Year 1: ~$136**

### Post-Launch (if needed):
- Supabase Pro: $25/month (if exceeding limits)
- Push Notification Service: Free with Expo
- Error Tracking: Free (Sentry free tier)
- **Potential Total: $0-25/month**

---

## ðŸš¨ Risk Management

### Common Issues & Solutions:

**Issue: Supabase free tier limits exceeded**
- Solution: Optimize storage, archive old data, or upgrade to Pro ($25/month)

**Issue: Push notifications not reliable**
- Solution: Use Expo Push (most reliable), test on physical devices, implement retry logic

**Issue: Real-time updates slow**
- Solution: Optimize subscriptions with filters, reduce payload size, consider pagination

**Issue: App store rejection**
- Solution: Follow guidelines carefully, provide demo account, respond quickly to reviewer

**Issue: Users not responding to notifications**
- Solution: Improve onboarding, make response easy, run training drills, gamify responses

---

## âœ… Definition of Done

Each stage is considered complete when:
1. All tasks checked off
2. Features working as expected
3. Tests passing
4. No critical bugs
5. Documentation updated
6. Code reviewed (if team)
7. Committed to git

---

## ðŸŽ“ Learning Resources

If you need help with specific technologies:

- **Supabase**: https://supabase.com/docs
- **React**: https://react.dev/
- **React Native**: https://reactnative.dev/
- **Expo**: https://docs.expo.dev/
- **TypeScript**: https://www.typescriptlang.org/docs/
- **Tailwind CSS**: https://tailwindcss.com/docs
- **Push Notifications**: https://docs.expo.dev/push-notifications/overview/

---

## ðŸ“ Notes

- This plan assumes solo developer or small team
- Adjust timelines based on your experience level
- Focus on MVP first (Stages 0-5) before adding advanced features
- Test frequently, deploy early and often
- Prioritize user feedback over new features
- Keep it simple, make it work, then make it better

---

**Ready to build something amazing! ðŸš€**

*Last Updated: November 12, 2025*


